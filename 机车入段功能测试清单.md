# 机车入段功能测试清单

## 功能概述
机车入段功能用于新增机车入段记录，包含基本信息填写、图片上传等功能。

## 测试环境准备
1. 确保应用已正确配置并可以运行
2. 确保网络连接正常，可以访问后端API
3. 准备测试用的车号数据
4. 准备测试用的图片（用于上传防溜照片）

## 测试路径
从主页 → "机车入段" → "新增入修" 进入功能页面

## 功能测试项

### 1. 页面加载测试
- [ ] 页面能够正常打开
- [ ] 页面标题显示为"机车入段"
- [ ] 底部显示"新增入段"按钮
- [ ] 所有必填字段都能正常显示

### 2. 数据加载测试
- [ ] 动力类型列表能够正常加载
- [ ] 机型列表能够正常加载（选择动力类型后）
- [ ] 配属段列表能够正常加载
- [ ] 检修地点列表能够正常加载
- [ ] 修程列表能够正常加载
- [ ] 修次列表能够正常加载（选择修程后）

### 3. 表单字段测试

#### 3.1 动力类型
- [ ] 能够点击选择动力类型
- [ ] 选择后能够正确显示选中的动力类型
- [ ] 选择动力类型后，机型列表能够自动更新

#### 3.2 机型
- [ ] 能够点击选择机型
- [ ] 选择后能够正确显示选中的机型

#### 3.3 车号
- [ ] 能够手动输入车号
- [ ] 输入车号后，能够自动查询并填充相关信息（机型、修程、修次、配属段）
- [ ] 输入不存在的车号时，不会报错（或显示友好提示）
- [ ] 输入已入段的车号时，能够正确处理（根据业务需求）

#### 3.4 配属段
- [ ] 能够点击选择配属段
- [ ] 选择后能够正确显示选中的配属段
- [ ] 通过车号自动填充的配属段能够正确显示

#### 3.5 修程
- [ ] 能够点击选择修程
- [ ] 选择后能够正确显示选中的修程
- [ ] 选择修程后，修次列表能够自动更新
- [ ] 通过车号自动填充的修程能够正确显示

#### 3.6 修次
- [ ] 能够点击选择修次
- [ ] 选择后能够正确显示选中的修次
- [ ] 通过车号自动填充的修次能够正确显示

#### 3.7 检修地点
- [ ] 能够点击选择检修地点
- [ ] 选择后能够正确显示选中的检修地点（格式：部门-轨道号-区域名）

#### 3.8 朝向
- [ ] 能够点击选择朝向（南/北）
- [ ] 选择后能够正确显示选中的朝向

#### 3.9 车号及防溜情况确认（图片上传）
- [ ] 能够点击选择图片
- [ ] 最多可以选择4张图片
- [ ] 选择的图片能够正确显示
- [ ] 能够删除已选择的图片
- [ ] 图片选择后能够正确转换为File对象

### 4. 表单验证测试
- [ ] 不填写车号，点击提交，显示"请填写车号"提示
- [ ] 不填写配属段，点击提交，显示"请填写配属段"提示
- [ ] 不填写修程，点击提交，显示"请填写修程"提示
- [ ] 不填写修次，点击提交，显示"请填写修次"提示
- [ ] 不填写检修地点，点击提交，显示"请填写检修地点"提示
- [ ] 不填写朝向，点击提交，显示"请填写朝向"提示
- [ ] 不上传图片，点击提交，显示"请填写检修图片"提示

### 5. 提交功能测试

#### 5.1 正常提交
- [ ] 填写所有必填字段后，点击"新增入段"按钮
- [ ] 提交时显示加载提示（"正在入段"）
- [ ] 提交成功后显示"机车入段提报成功"对话框
- [ ] 点击"确定"后能够正确返回上一页
- [ ] 提交成功后，表单数据能够正确保存到后端

#### 5.2 图片上传
- [ ] 选择图片后提交，图片能够正确上传
- [ ] 图片上传成功后，图片列表能够正确清空
- [ ] 图片上传失败时，能够显示错误提示

#### 5.3 异常处理
- [ ] 网络异常时，能够显示友好错误提示
- [ ] 服务器返回错误时，能够正确显示错误信息
- [ ] 重复提交时，能够防止重复提交（isSubmitting机制）
- [ ] 提交过程中，按钮显示加载状态

### 6. 边界情况测试
- [ ] 车号为空的边界情况
- [ ] 车号格式错误的边界情况
- [ ] 图片数量为0的情况
- [ ] 图片数量达到上限（4张）的情况
- [ ] 快速连续点击提交按钮的情况
- [ ] 页面在提交过程中被关闭的情况

### 7. 用户体验测试
- [ ] 所有选择器都有合适的提示文字
- [ ] 加载状态有明确的视觉反馈
- [ ] 错误提示信息清晰易懂
- [ ] 表单布局合理，易于操作
- [ ] 图片选择器操作流畅

### 8. API接口测试
- [ ] `/subparts/jcDynamicType/selectAll` - 获取动力类型
- [ ] `/subparts/jcType/selectAll` - 获取机型（需要动力类型参数）
- [ ] `/dispatch/jcAssignSegment/selectAll` - 获取配属段
- [ ] `/subparts/stopPosition/selectAll` - 获取检修地点
- [ ] `/subparts/repairProc/selectAll` - 获取修程
- [ ] `/subparts/repairTimes/selectAll` - 获取修次（需要修程参数）
- [ ] `/plan/repairPlan/getRepairPlanByTrainNum` - 通过车号查询计划信息
- [ ] `/dispatch/trainEntry/save` - 保存入段信息
- [ ] `/fileserver/antiSlipFile/uploadFile` - 上传防溜照片

## 已知问题
1. `getRepairPlanByTrainNum` 方法中，如果返回的数据为null或缺少字段，可能会导致错误（虽然有try-catch保护）
2. 车号输入后自动查询的逻辑中，如果查询失败，没有明确的用户提示

## 测试建议
1. 建议先测试正常流程，确保基本功能可用
2. 然后测试各种异常情况，确保错误处理正确
3. 最后测试边界情况，确保系统稳定性
4. 建议在不同网络环境下测试（正常网络、慢速网络、断网等）

## 测试数据建议
- 准备有效的车号用于测试
- 准备无效的车号用于测试错误处理
- 准备已入段的车号用于测试重复入段处理
- 准备不同格式的图片用于测试图片上传

